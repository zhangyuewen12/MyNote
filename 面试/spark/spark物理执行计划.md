# **spark如何生成物理执行任务的?**

spark采用的方法是根据 数据依赖关系，来将逻辑处理流程（Login plan）转化为物理执行计划（physical plan)，包括执行阶段(stage)、执行任务(task)。具体包括三个步骤:

1. 首先确定应用会产生哪些作业（job）。根据代码中的action操作来划分Job
2. 根据逻辑处理流程中的数据依赖关系，将每个job的处理流程拆分为执行阶段(stage)。
3. 最后，对于每个stage,根据RDD的分区个数确定执行的task个数和种类。